<mat-toolbar color="ThemePalette" class="main-nav-bar">
  <mat-toolbar-row>
    <span
      id="app-logo"
      class="optisam-logo"
      matTooltip="{{ 'Dashboard' | translate }}"
      [hidden]="this.sidebarFlag"
      routerLink="/optisam/dashboard"
    >
      <img src="assets/images/OpTISAM-Logo.svg" />
    </span>
    <span
      id="app-logo-min"
      class="optisam-logo"
      matTooltip="{{ 'Dashboard' | translate }}"
      [hidden]="!this.sidebarFlag"
      routerLink="/optisam/dashboard"
    >
      <img src="assets/images/OpTISAM-Logo-app.svg" />
    </span>
    <button mat-icon-button (click)="toggleSideNavbar()">
      <mat-icon id="nav-menu">menu</mat-icon>
    </button>
    <a
      id="nav-scopes-menu"
      *ngIf="selectedScope && scopesList.length === 0"
      matTooltip="{{ 'Scope' | translate }}"
      mat-button
    >
      <img
        style="height: 24px"
        src="\assets\images\scope-management-blue.svg"
      />
      {{ selectedScope.scope_code }}
    </a>
    <a
      id="nav-scopes-menu"
      *ngIf="selectedScope && scopesList.length > 0"
      matTooltip="{{ 'Scope' | translate }}"
      mat-button
      [matMenuTriggerFor]="scopesMenu"
    >
      <img
        style="height: 24px"
        src="\assets\images\scope-management-blue.svg"
      />
      {{ selectedScope.scope_code }}
      <mat-icon>arrow_drop_down</mat-icon>
    </a>
    <mat-menu #scopesMenu="matMenu">
      <button
        id="nav-{{ scope }}"
        mat-menu-item
        *ngFor="let scope of scopesList"
        (click)="setScope(scope, warningDialog, warningDashboardDialog)"
      >
        {{ scope.scope_code }}
      </button>
    </mat-menu>

    <span class="example-spacer"></span>
    <div fxShow="true" fxHide.lt-md="true">
      <a
        id="nav-management-menu"
        mat-button
        [matMenuTriggerFor]="menu2"
        (menuOpened)="menuOpened()"
        *ngIf="role === 'ADMIN' || role === 'SUPER_ADMIN'"
      >
        <img style="height: 24px" src="\assets\images\Admin-2.svg" />
        {{ "ADMINISTRATION" | translate }}
      </a>

      <!-- <a id="nav-management-menu" mat-button *ngIf="role === 'SUPER_ADMIN'">
        <img style="height: 24px" src="\assets\images\Admin-2.svg" />
        {{ "ADMINISTRATION" | translate }}
      </a> -->

      <mat-menu #menu2>
        <ng-container *ngFor="let menuItem of navMenuItems">
          <button
            mat-menu-item
            *ngIf="menuItem.auth.includes(role)"
            matTooltip="{{ menuItem.matTooltip | translate }}"
            [routerLink]="[menuItem.routerLink]"
            [routerLinkActive]="['routeactive']"
            [attr.id]="menuItem.id"
          >
            <!-- mat icon -->
            <ng-container *ngIf="menuItem.isMatIcon">
              <mat-icon class="mat-icon-admin">{{
                menuItem.matIconName
              }}</mat-icon>
            </ng-container>
            <!--  image -->
            <ng-container *ngIf="!menuItem.isMatIcon">
              <img
                class="menu-item-icon-img"
                [attr.style]="menuItem.imgStyle"
                [src]="menuItem.imgSrc"
              />
            </ng-container>
            {{ menuItem.menuItemName | translate }}
          </button>
        </ng-container>
      </mat-menu>

      <a id="nav-admin-menu" mat-button [matMenuTriggerFor]="menu">
        <mat-icon class="mat-icon-header" matsuffix>face</mat-icon>
        {{ userName }}
      </a>

      <mat-menu #menu="matMenu">
        <button id="nav-settings" mat-menu-item (click)="langchange()">
          <mat-icon class="mat-icon-admin" matsuffix>settings</mat-icon>
          {{ "Settings" | translate }}
        </button>
        <button id="nav-logout" mat-menu-item (click)="logout()">
          <mat-icon class="mat-icon-admin" matsuffix>logout</mat-icon>
          {{ "Logout" | translate }}
        </button>
      </mat-menu>

      <a
        id="nav-language-menu"
        mat-button
        [matMenuTriggerFor]="menu1"
        (click)="checkLanguage()"
      >
        <mat-icon class="mat-icon-header" matsuffix>language</mat-icon>
        {{ "language" | translate }}
        <mat-icon>arrow_drop_down</mat-icon>
      </a>
      <mat-menu #menu1="matMenu">
        <button
          id="nav-language-en"
          mat-menu-item
          *ngIf="currLang == 'fr'"
          (click)="updateUserLanguage('en')"
        >
          <img class="flags" src="assets/images/en.png" />English
        </button>
        <button
          id="nav-language-fr"
          mat-menu-item
          *ngIf="currLang == 'en'"
          (click)="updateUserLanguage('fr')"
        >
          <img class="flags" src="assets/images/fr.png" />French
        </button>
      </mat-menu>

      <a id="nav-help" mat-button [matMenuTriggerFor]="menu3">
        <mat-icon class="mat-icon-header" matsuffix>help_outline</mat-icon>
      </a>
      <mat-menu #menu3="matMenu">
        <a
          id="nav-user-guide"
          mat-menu-item
          href="https://optisam.pages.gitlab.tech.orange/optisam-it/optisam-ui/"
          target="_blank"
        >
          <mat-icon class="mat-icon-menu">help_outline</mat-icon
          >{{ "User Guide" | translate }}
        </a>
        <button id="nav-about" mat-menu-item (click)="openAboutUs()">
          <mat-icon class="mat-icon-menu">info_outline</mat-icon
          >{{ "About" | translate }}
        </button>
      </mat-menu>
    </div>
  </mat-toolbar-row>
</mat-toolbar>

<ng-template #warningDialog>
  <mat-dialog-content>
    <p>
      {{ "Changing scope to " | translate }}
      <strong>{{ newScope.scope_code }}</strong
      >.
    </p>
    <p>
      {{ "You will be taken to the dashboard after clicking OK." | translate }}
    </p>
  </mat-dialog-content>
  <mat-dialog-actions align="center">
    <button
      mat-button
      [mat-dialog-close]="true"
      class="btn-two"
      (click)="backToHome(); changeScope()"
      cdkFocusInitial
    >
      {{ "OK" | translate }}
    </button>
    <button
      mat-button
      [mat-dialog-close]="true"
      class="btn-three"
      cdkFocusInitial
    >
      {{ "Cancel" | translate }}
    </button>
  </mat-dialog-actions>
</ng-template>
<ng-template #warningDashboardDialog>
  <mat-dialog-content>
    <p>
      {{ "Changing scope to " | translate }}
      <strong>{{ newScope.scope_code }}</strong
      >.
    </p>
    <p>{{ "You will see the new data after clicking OK." | translate }}</p>
  </mat-dialog-content>
  <mat-dialog-actions align="center">
    <button
      mat-button
      [mat-dialog-close]="true"
      class="btn-two"
      (click)="changeScope()"
      cdkFocusInitial
    >
      {{ "OK" | translate }}
    </button>
    <button
      mat-button
      [mat-dialog-close]="true"
      class="btn-three"
      cdkFocusInitial
    >
      {{ "Cancel" | translate }}
    </button>
  </mat-dialog-actions>
</ng-template>
